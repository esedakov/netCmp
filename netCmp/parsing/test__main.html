<!---
	Developer:	Eduard Sedakov
	Date:		2015-10-14
	Description:	test HTML for loading all JS and running/debugging
	Used by:	(testing)
	Dependencies:	(everything)
--->

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<!-- external libraries -->
	<link rel="stylesheet" type="text/css" href="../external/joint.css">
	<script src="../external/jquery.min.js"></script>
	<script src="../external/lodash.min.js"></script>
	<script src="../external/backbone-min.js"></script>
	<script src="../external/joint.js"></script>
	<!--<script src="../external/jquery-1.11.3.min.js"></script>-->
	<!-- lexer -->
	<script src="../lexer/type__token.js"></script>	<!-- constants -->
	<script src="../lexer/obj__token.js"></script>	<!-- token object -->
	<script src="../lexer/lexer.js"></script>		<!-- lexer -->
	<!-- pre-processor -->
	<script src="../preprocessor/preprocessor.js"></script>
	<!-- utilities -->
	<script src="./util__sha256.js"></script>	<!-- hashing algorithm -->
	<script src="./util__type__entity.js"></script>	<!-- entity types -->
	<script src="./util__lib.js"></script>		<!-- library of auxilary functions -->
	<script src="./util__result.js"></script>	<!-- result object -->
	<!-- types -->
	<script src="./type__argument.js"></script>		<!-- type: argument -->
	<script src="./type__blockToBlockTransfer.js"></script>	<!-- type: b2b -->
	<script src="./type__command.js"></script>		<!-- type: command -->
	<script src="./type__function.js"></script>		<!-- type: function -->
	<script src="./type__obj.js"></script>			<!-- type: object -->
	<script src="./type__scope.js"></script>		<!-- type: scope -->
	<script src="./type__symbol.js"></script>		<!-- type: symbol -->
	<script src="./type__log_node.js"></script>		<!-- type: logic node -->
	<script src="./type__log_op.js"></script>		<!-- type: logic operation -->
	<!-- entities -->
	<script src="./obj__argument.js"></script>		<!-- argument entity -->
	<script src="./obj__block.js"></script>			<!-- block entity -->
	<script src="./obj__command.js"></script>		<!-- command entity -->
	<script src="./obj__functinoid.js"></script>		<!-- function definition entity -->
	<script src="./obj__program.js"></script>		<!-- program entity -->
	<script src="./obj__scope.js"></script>			<!-- scope entity -->
	<script src="./obj__symbol.js"></script>		<!-- symbol entity -->
	<script src="./obj__type.js"></script>			<!-- type entity -->
	<script src="./obj__value.js"></script>			<!-- constant entity -->
	<!-- pre-defined language types (not finished, yet) -->
	<script src="./obj__objectType.js"></script>		<!-- text type -->
	<script src="./obj__arrayGenericType.js"></script>	<!-- array<...> type -->
	<script src="./obj__boolType.js"></script>		<!-- boolean type -->
	<script src="./obj__hashGenericType.js"></script>	<!-- hash<... , ...> type -->
	<script src="./obj__intType.js"></script>		<!-- int type -->
	<script src="./obj__realType.js"></script>		<!-- floating point type -->
	<script src="./obj__textType.js"></script>		<!-- text type -->
	<script src="./obj__voidType.js"></script>		<!-- void type -->
	<script src="./obj__drawingType.js"></script>	<!-- ES 2016-06-05 (b_interpreter_2): setup drawing type -->
	<!-- logic tree -->
	<script src="./obj__log_node.js"></script>		<!-- logic node -->
	<script src="./obj__logic_tree.js"></script>	<!-- logic tree -->
	<!-- actual parser code -->
	<script src="./parser.js"></script>				<!-- parser -->
	<!-- interpreting objects -->
	<script src="../interpreter/obj__position.js"></script>	<!-- position in the code -->
	<script src="../interpreter/obj__iterator.js"></script>	<!-- FOREACH loop iterator -->
	<script src="../interpreter/obj__content.js"></script>	<!-- singleton value objects -->
	<script src="../interpreter/obj__funcCall.js"></script>	<!-- function call information -->
	<script src="../interpreter/obj__entity.js"></script>	<!-- instantiated symbol -->
	<script src="../interpreter/obj__frame.js"></script>	<!-- instantiated scope -->
	<!-- load language libraries -->
	<!-- 1. B+ tree -->
	<script src="../lib/B+Tree/type__b+_node.js"></script>
	<script src="../lib/B+Tree/obj__pair.js"></script>
	<script src="../lib/B+Tree/obj__b+_node.js"></script>
	<script src="../lib/B+Tree/b+_tree.js"></script>
	<!-- 2. Drawing -->
	<script src="../lib/Drawing/drawing.js"></script>
	<!-- actual interpreter code -->
	<script src="../interpreter/interpreter.js"></script>
	<!-- test file -->
	<!--<script src="./test__utils.js"></script>-->		<!-- test for utilities -->
	<!--<script src="./test__parsingEntities.js"></script>-->	<!-- test for parsing -->
	<!--<script src="./test__objType.js"></script>-->
	<script src="./util__vis.js"></script>
</head>
<body>
	<!-- according to example on http://www.jointjs.com/tutorial, create
		global container for joint to draw elements inside -->
	<div id="myholder"></div>
	<script type="text/javascript">
		function run_tests(){
			//////test utilities
			//////run_util_tests();
			//////test parsing entities
			//////run_parsing_entities_tests();
			////run_obj_type_tests();
			////return false;
			//var glWidth = 1600, glHeight = 1600;
			//test_viz('myholder', glWidth, glHeight);
			//initialize code segement to parse
			//var code = "object goo{\n" +
			//				"foo<integer>:_k\n" +
			//			"};\n" +
			//			"object<K> foo{\n" + 
			//				"integer:_i,\n" + 
			//				"real:_f,\n" + 
			//				"function foo:__create__(integer i,real f){},\n" +
			//				"function integer:getI(){return this._i;\n" + 
			//				"}\n" +
			//			"};\n" + 
			//			"function foo<integer>:__main__(){}.";
			/*var code  = "object<_Ty> foo{\n" +
							"integer:_idx,\n" +
							"_Ty:_data,\n" +
							"function integer:getIndex(){\n" +
								"return this._idx\n" +
							"},\n" +
							"function _Ty:getData(){\n" +
								"return this._data\n" +
							"}\n" +
						"};\n" +
						"object goo{\n" +
							"foo<<integer>>:_data,\n" +
							"function integer:getFooData(boolean doGetIdx){\n" +
								"if doGetIdx == true {\n" +
									"return this._data._idx\n" +
								"} else {\n" +
									"return this._data._data\n" +
								"}\n" +
							"}\n" + 
						"};\n" +
						"function integer:__main__(){\n" +
							"var goo it;\n" +
							"return call it.getFooData(true)\n" +
						"}.";*/
			/*var code  = "function integer:print(integer i){\n" +
							"return i * 2\n" +
						"};\n" +
						"function integer:__main__(){\n" +
							"var integer i = 0;\n" +
							"while i < 10 {\n" +
								"if i == 0 {\n" +
									"let i = 1\n" +
								"} else {\n" + 
									"if i =< 4 {\n" +
										"let i = i + 1\n" +
									"} else {\n" +
										"let i = 11\n" +
									"}\n" +
								"};\n" +
								"call print(i)\n" +
							"};\n" +
							"return i mod 5\n" +
						"}.";*/
			/*var code = "function void:__main__(){" +
							"var array<<integer>> arr;" +
							"call arr.insert(1);" +
							//"var integer i_0 = call arr.get(0);" +
							"var integer i_0 = arr[0];" +
							"let arr[1] = i_0 / 2;" +
							"var integer i_1 = call arr.remove(i_0)" +
						"}.";*/
			/*var code = "object elem{\n" +
							"integer:_type,\n" +	//0:nothing, 1:wall, 2:block, 3:keeper
							"integer:_x,\n" +
							"integer:_y,\n" +
							"function elem:__constructor__(integer type, integer x, integer y){\n" +
								"let this._type = type;\n" +
								"let this._x = x;\n" +
								"let this._y = y;\n" +
								"return this\n" +
							"}\n" +
							//"function text:__toString__(){\n" +
							//	"return \"elem:\" + this._type.__toString__()\n" +
							//"}\n" +
						"};\n" +
						"function elem:createElement(integer type, integer x, integer y){\n" +
							"var elem e;\n" +
							"let e._type = type;\n" +
							"let e._x = x + 1;\n" +
							"let e._y = y;\n" +
							"return e\n" +
						"};\n" +
						"object pos{\n" +
							"integer:_x,\n" +
							"integer:_y,\n" +
							"function pos:__constructor__(integer x, integer y){\n" +
								"let this._x = x;\n" +
								"let this._y = y;\n" +
								"return this\n" +
							"},\n" +
							"function text:getText(){\n" +
								"return call this._x.__tostring__() + call this._y.__tostring__()\n" +
							"}\n" +
						"};\n" +
						//"function pos:createPosition(integer x, integer y){\n" +
						//	"var pos p;\n" +
						//	"let p._x = x;\n" +
						//	"let p._y = y;\n" +
						//	"return p\n" +
						//"};\n" +
						"function void:__main__(){\n" +
						
							"var array<<elem>> arr;" +
							//X0123
							//0****
							//1*b *
							//2* k*
							//3****
							"call arr.insert(call createElement(1, 0, 0));\n" +
							"call arr.insert(var elem(1, 1, 0));\n" +
							"call arr.insert(call createElement(1, 2, 0));\n" +
							"call arr.insert(call createElement(1, 3, 0));\n" +
							"call arr.insert(call createElement(1, 0, 1));\n" +
							"call arr.insert(call createElement(2, 1, 1));\n" +
							"call arr.insert(call createElement(0, 2, 1));\n" +
							"call arr.insert(call createElement(1, 3, 1));\n" +
							"call arr.insert(call createElement(1, 0, 2));\n" +
							"call arr.insert(call createElement(0, 1, 2));\n" +
							"call arr.insert(call createElement(3, 2, 2));\n" +
							"call arr.insert(call createElement(1, 3, 2));\n" +
							"call arr.insert(call createElement(1, 0, 4));\n" +
							"call arr.insert(call createElement(1, 1, 4));\n" +
							"call arr.insert(call createElement(1, 2, 4));\n" +
							"call arr.insert(call createElement(1, 3, 4));\n" +
							"var pos keeper = var pos(1,9);\n" +
							"var text t_keeper = keeper.getText();\n" +
							//"var pos block;\n" +
							//"foreach( cur:arr ){\n" +
							//	"if cur._type == 2 {\n" +
							//		"let block._x = cur._x;\n" +
							//		"let block._y = cur._y\n" +
							//	"} else {\n" +
							//	//"} else if cur._type == 3 {\n" +
							//		"let keeper._x = cur._x;\n" +
							//		"let keeper._y = cur._y\n" +
							//	"}\n" +
							//"};\n" +
							"call arr.remove(5)\n" +
						"}.\n";*/
			/*var code = "function void:__main__(){\n" +
							"var tree<<integer, real>> t = var tree<<integer, real>>();\n" +
							"call t.insert(1.4, 5);\n" +	//1
							"call t.insert(2.1, 11);\n" +	//2
							"call t.insert(3.4, 17);\n" +	//3
							"call t.insert(4.1, 1);\n" +	//4
							"call t.insert(5.4, 9);\n" +	//5
							"call t.insert(6.1, 10);\n" +	//6
							"call t.insert(7.4, 2);\n" +	//7
							"call t.insert(8.1, 30);\n" +	//8
							"call t.insert(9.4, 6);\n" +	//9
							"call t.insert(10.1, 8);\n" +	//10
							"call t.insert(11.4, 3);\n" +	//11
							"call t.insert(12.1, 15);\n" +	//12
							"call t.insert(13.4, 31);\n" +	//13
							"call t.insert(14.1, 18);\n" +	//14
							"call t.insert(15.4, 20);\n" +	//15
							"var real max = call t.getmax();\n" +
							"var real min = call t.getmin();\n" +
							"call t.remove(2);\n" +		//1
							"call t.remove(11);\n" +	//2
							"call t.remove(18);\n" +	//3
							"call t.remove(4);\n" +		//4 -- miss
							"call t.remove(17);\n" +	//5
							"call t.remove(6);\n" +		//6
							"call t.remove(30);\n" +	//7
							"call t.remove(5);\n" +		//8
							"call t.remove(15);\n" +	//9
							"call t.remove(17);\n" +	//10 -- miss
							"call t.remove(10);\n" +	//11
							"call t.remove(1);\n" +		//12
							"call t.remove(9);\n" +		//13
							"call t.remove(8);\n" +		//14
							"call t.remove(20);\n" +	//15
							"call t.remove(3);\n" +		//16
							"call t.remove(31)\n" +		//17 -- at this point tree is empty
						"}.\n";*/
			/*var code = "function void:__main__(){\n" +
							"var array<<real>> a = var array<<real>>();\n" +
							//is empty
							"var boolean ise1 = call a.isempty();\n" +	//empty
							//inserts
							"call a.insert(1.4, 0);\n" +				//insert at start
							"call a.insert(2.1, 1);\n" +				//insert at end
							"call a.insert(3.4, 0);\n" +				//insert at start
							"call a.insert(4.1, 2);\n" +				//insert at middle
							"call a.insert(5.4, 1);\n" +				//insert at middle
							"call a.insert(6.1, 5);\n" +				//insert at end
							//[3.4, 5.4, 1.4, 4.1, 2.1, 6.1]
							"var integer i1 = call a.index(4.1);\n" +	//index = 3
							"var integer i2 = call a.index(6.1);\n" +	//index = 5
							"var integer i3 = call a.index(3.4);\n" +	//index = 0
							//[3.4, 5.4, 1.4, 4.1, 2.1, 6.1]
							"var real a1 = call a.get(0);\n" +			//value = 3.4
							"var real a2 = call a.get(3);\n" +			//value = 4.1
							"var real a3 = call a.get(5);\n" +			//value = 6.1
							//is empty
							"var boolean ise2 = call a.isempty();\n" + 	//not empty
							//get length
							"var integer l1 = call a.length();\n" +		//length = 6
							//removes
							"call a.remove(0);\n" +						//remove at start	= 3.4
							"call a.remove(1);\n" +						//remove at middle	= 1.4
							"call a.remove(3);\n" +						//remove at end		= 6.1
							"call a.remove(2);\n" +						//remove at end		= 2.1
							"call a.remove(0);\n" +						//remove at start	= 5.4
							//get length
							"var integer l2 = call a.length();\n" +		//length = 1
							//[4.1]
							//remove all
							"call a.removeall();\n" +					//remove all
							//is empty
							"var boolean ise3 = call a.isempty()\n" +	//empty
						"}.\n";*/
			/*var code =	"function void:__main__(){\n" +
							"var drawing drw = var drawing();\n" +
							"call drw.settxtposition(0.5, 0.35);\n" +
							"call drw.drawrect(100, 100, 500, 300, 1, 'red', 2, 'green', 15, 15, 'hello world! hello world.\nhello world?')\n" +
						"}.\n";*/
			var code =	"object<_Ty> point{\n" +
							"integer:_idx,\n" +
							"_Ty:_x,\n" +
							"_Ty:_y,\n" +
							"function _Ty:square(){\n" +
								"return this._x * this._x + this._y * this._y\n" +
							"},\n" +
							"function point<<_Ty>>:__constructor__(_Ty x, _Ty y){\n" +
								"let this._x = x;\n" +
								"let this._y = y;\n" +
								"return this\n" +
							"},\n" +
							"function _Ty:getX(){\n" +
								"return this._x\n" +
							"},\n" +
							"function _Ty:getY(){\n" +
								"return this._y\n" +
							"}\n" +
						"};\n" +
						"function void:__main__(){\n" +
							"var array<<point<<integer>>>> a;\n" +
							"call a.insert(var point<<integer>>(0,1),0);\n" +
							"call a.insert(var point<<integer>>(2,3),1);\n" +
							"call a.insert(var point<<integer>>(4,5),2);\n" +
							"var drawing drw = var drawing();\n" +
							"var text txt;\n" +
							"call drw.settxtposition(0.5, 0.35);\n" +
							"foreach( cur : a ){\n" +
								"let txt = txt + call (call cur.square()).tostring() + ','\n" +
							"};\n" +
							"call drw.drawrect(100,100,500,300,1,'red',2,'green',15,15,txt)\n" +
						"}.\n;";
			////this code line is inside interpreter
			////create instance of parser
			//var p = new parser(code);
			////this code line is inside interpreter
			////process program
			//p.process__program();
			////Next code block is responsible for drawing CFG
			////start of CFG drawing code block:
			//var w = 1600, h = 55600, id = 'myholder';
			////run test function
			//var g_scp = p._gScp;
			////create visualization component
			//var v = new viz(id, w, h);
			////draw CFG
			//v.drawCFG(g_scp);
			////end of CFG drawing code block.
			//start of interpreter code block:
			var intrp = new interpreter(code);
			//end of interpreter code block.
		};
	</script>
	<!-- rather then start test runs right away, use click event (easier to debug) -->
	To start testing press <a
		href="javascript:void(0);"
		onclick="run_tests();"
	>here</a>.
	<!--<div id="outputDiv"></div>-->
</body>
</html>
